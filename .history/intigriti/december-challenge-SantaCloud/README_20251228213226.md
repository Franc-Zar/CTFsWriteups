# Intigriti's SantaCloud CTF challenge by [INTIGRITI](https://x.com/intigriti)

## Description

The solution:

* Should leverage a vulnerability on the challenge page.
* Shouldn't be self-XSS or related to MiTM attacks.
* Should require no user interaction.
* Should require no bruteforcing (if you have to, keep requests below 1 req/sec).
* Should include:
    * The flag in the format INTIGRITI{.*}
    * The payload(s) used
    * Steps to solve (short description / bullet points)
* Should be reported on the Intigriti platform.

Get started:

Repeat your attack against the [challenge server](https://santacloud.intigriti.io/home).

## TL;DR


## Analysis

The target is a **black-box web application** implementing a supply-chain portal for coordinating Christmas gifts, a system of... debatable usefulness. 
I mean, who would actually need something like this? Right?

![](https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDZhdzU1NTR4dDkxZXdoNDNsOGE3M2pwbDljMnE5djhzc3czOXh3NiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l2SqbZ1ggNuRHZkeA/giphy.gif)

At this point, we can only trust that the devel(f)opers implemented this correctly. Otherwise, Christmas might not survive the deployment.

![login](./imgs/login.png)

With no option for user registration and authentication restricted to existing accounts, the attack surface initially lies outside the login flow. 
Broad reconnaissance and endpoint enumeration are necessary to uncover exposed APIs, leaked data, and misconfigurations that could be chained into an authentication bypass.

The relevant endpoints were identified through **file/directory enumeration** performed with [gobuster](https://github.com/OJ/gobuster). 
These are listed below:

```bash
/                     (Status: 200) [Size: 3924]
/cgi-bin/             (Status: 301) [Size: 335] [--> http://santacloud.intigriti.io/cgi-bin]
/css                  (Status: 301) [Size: 332] [--> http://santacloud.intigriti.io/css/]
/home                 (Status: 200) [Size: 8094]
/images               (Status: 301) [Size: 335] [--> http://santacloud.intigriti.io/images/]
/inventory            (Status: 200) [Size: 11499]
/login                (Status: 200) [Size: 5883]
/map                  (Status: 200) [Size: 12945]
/notes                (Status: 200) [Size: 15135]
/profile              (Status: 200) [Size: 7523]
/up                   (Status: 200) [Size: 1954]
```

Moreover, 

```js
const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
```